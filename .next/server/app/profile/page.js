(()=>{var e={};e.id=636,e.ids=[636],e.modules={96330:e=>{"use strict";e.exports=require("@prisma/client")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},79646:e=>{"use strict";e.exports=require("child_process")},55511:e=>{"use strict";e.exports=require("crypto")},14985:e=>{"use strict";e.exports=require("dns")},94735:e=>{"use strict";e.exports=require("events")},29021:e=>{"use strict";e.exports=require("fs")},79748:e=>{"use strict";e.exports=require("fs/promises")},81630:e=>{"use strict";e.exports=require("http")},55591:e=>{"use strict";e.exports=require("https")},91645:e=>{"use strict";e.exports=require("net")},21820:e=>{"use strict";e.exports=require("os")},33873:e=>{"use strict";e.exports=require("path")},27910:e=>{"use strict";e.exports=require("stream")},34631:e=>{"use strict";e.exports=require("tls")},79551:e=>{"use strict";e.exports=require("url")},28354:e=>{"use strict";e.exports=require("util")},74075:e=>{"use strict";e.exports=require("zlib")},4573:e=>{"use strict";e.exports=require("node:buffer")},77598:e=>{"use strict";e.exports=require("node:crypto")},57975:e=>{"use strict";e.exports=require("node:util")},12766:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>l.a,__next_app__:()=>u,pages:()=>d,routeModule:()=>p,tree:()=>c});var s=t(70260),n=t(28203),a=t(25155),l=t.n(a),i=t(67292),o={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);t.d(r,o);let c=["",{children:["profile",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,21762)),"C:\\Users\\User\\Documents\\Hi world\\ADRAR 2024\\Fil Rouge\\app\\profile\\page.tsx"]}]},{}],auth:["__DEFAULT__",{},{defaultPage:[()=>Promise.resolve().then(t.bind(t,91985)),"C:\\Users\\User\\Documents\\Hi world\\ADRAR 2024\\Fil Rouge\\app\\@auth\\default.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,1033)),"C:\\Users\\User\\Documents\\Hi world\\ADRAR 2024\\Fil Rouge\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,89977)),"C:\\Users\\User\\Documents\\Hi world\\ADRAR 2024\\Fil Rouge\\app\\not-found.tsx"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,69116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,41485,23)),"next/dist/client/components/unauthorized-error"]}],d=["C:\\Users\\User\\Documents\\Hi world\\ADRAR 2024\\Fil Rouge\\app\\profile\\page.tsx"],u={require:t,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:n.RouteKind.APP_PAGE,page:"/profile/page",pathname:"/profile",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},54667:(e,r,t)=>{"use strict";t.r(r),t.d(r,{"00fd58976968bd360b0b51da2c89d0ff02e76d2f2c":()=>n.A,"7fe13f6264349238c6e48141c1e4a57ee047053936":()=>s.Y});var s=t(53337),n=t(96700)},13522:(e,r,t)=>{"use strict";t.r(r),t.d(r,{"0020711e683fce2295dcae5b03dba6b4bb1f7f7653":()=>w,"7f18c30c8768a9e22fdb2c3dd272f2ab4d6f47def8":()=>x,"7f79946f45de2eea1739a88c4620698c367ede93b0":()=>h,"7f86c437f75ffeab4332bd128663d1faa33add1145":()=>d,"7fb44f0178c4951b568ad269ec66e74635f4a91807":()=>g,"7fd919d4267e3516d1ebfb2bae9c83eac9c99aecc3":()=>j});var s=t(21590);t(70376);var n=t(33582),a=t(97585),l=t(38803),i=t(75328),o=t(9342),c=t(99344);let d=async({eventId:e,participantsIds:r})=>{try{let t=await (0,n.j2)();if(!t||!t.user?.id||!e)throw Error("No session found or missing data");let s=await (0,a.Yw)(e);if(!s||s.id!==e||!s.conversation)throw Error("L'\xe9v\xe9nement n'existe pas");let c=r.map(e=>s.UserInvitations?.find(r=>r.participantId===e)),d=r.filter(e=>!c.find(r=>r?.participantId===e)),u=await Promise.all(d.map(async r=>(0,i.o)({creatorId:t.user?.id,participantId:r,eventId:e,status:"WAITING_PARTICIPANT_RESPONSE",conversationId:s.conversation?.id})));return await Promise.all(r.map(async e=>(0,l.cb)({userId:e,conversationId:s.conversation?.id,role:"GUEST"}))),await Promise.all(u.map(e=>(0,o._)({conversationId:s.conversation?.id,invitationId:e.id,message:`Bonjour, je vous invite \xe0 mon nouvel \xe9v\xe9nement ${s.title} !`}))),c&&c.length>0&&(await Promise.all(c.map(async r=>{r?.participantId&&await (0,i.h)({eventId:e,participantId:r.participantId,status:"WAITING_PARTICIPANT_RESPONSE"})})),await Promise.all(c.map(async e=>{e?.id&&await (0,o._)({conversationId:s.conversation?.id,invitationId:e.id,message:`Bonjour, je vous invite \xe0 mon nouvel \xe9v\xe9nement ${s.title} !`})}))),{ok:!0,message:"Invitation envoy\xe9e"}}catch(e){return console.error("sendInvitationToEvent: error",e),{ok:!1,message:"Une erreur est survenue"}}};(0,c.D)([d]),(0,s.A)(d,"7f86c437f75ffeab4332bd128663d1faa33add1145",null);var u=t(40492);let p=async({userId:e,content:r,completed:t,eventId:s,order:n})=>{try{return await u.A.tasks.create({data:{userId:e,content:r,completed:t,eventId:s,order:n}})}catch(e){throw console.error("createTaskService: error",e),Error("Service error: createTaskService")}},m=async({taskId:e})=>{try{return await u.A.tasks.delete({where:{id:e}}),!0}catch(e){throw console.error("deleteTaskService: error",e),Error("Service error: deleteTaskService")}},f=async({taskId:e,content:r,completed:t,order:s})=>{try{return await u.A.tasks.update({where:{id:e},data:{content:r,completed:t,order:s}})}catch(e){throw console.error("UpdateTasksService: error",e),Error("Service error: UpdateTasksService")}},x=async e=>{let r=await (0,n.j2)();if(!r){console.error("createTask: no session found");return}try{let t=await p({userId:r.user.id,content:e.content,completed:e.completed,eventId:e.eventId,order:0});return{ok:!0,newTask:t}}catch(e){return console.error(e),{ok:!1,error:e}}};(0,c.D)([x]),(0,s.A)(x,"7f18c30c8768a9e22fdb2c3dd272f2ab4d6f47def8",null);let h=async e=>{if(!await (0,n.j2)()){console.error("deleteUserTask: no session found");return}try{return await m({taskId:e}),{ok:!0}}catch(e){return console.error("deleteUserTask error:",e),{ok:!1,error:e}}};(0,c.D)([h]),(0,s.A)(h,"7f79946f45de2eea1739a88c4620698c367ede93b0",null);let g=async e=>{try{return await f({taskId:e.id,content:e.content,completed:e.completed,order:e.order}),{ok:!0}}catch(e){return console.error(e),{ok:!1}}};(0,c.D)([g]),(0,s.A)(g,"7fb44f0178c4951b568ad269ec66e74635f4a91807",null);var v=t(26490),b=t(76752);let j=async({eventId:e})=>{let r=await (0,n.j2)();if(!r)return console.error("deleteEvent: no session found"),{error:"no session found"};try{let t=await (0,a.Yw)(e);if(!t)return console.error("deleteEvent: event not found"),{ok:!1,message:"Aucun \xe9v\xe9nement trouv\xe9"};if("admin"!==r.user.role&&t.user?.id!==r.user.id)return console.error("deleteEvent: user is not the creator"),{ok:!1,message:"Vous n'\xeates pas le cr\xe9ateur de cet \xe9v\xe9nement"};return t.conversation&&await (0,v._g)(t.conversation.id),t.Tasks&&t.Tasks.length>0&&await Promise.all(t.Tasks.map(e=>h(e.id))),await (0,a.DN)(e),t.image&&await (0,b.v)(t.image),{ok:!0,message:"\xc9v\xe9nement supprim\xe9 avec succ\xe8s"}}catch(e){return console.error(e),{ok:!1,message:"Erreur lors de la suppression de l'\xe9v\xe9nement"}}};async function w(){try{await (0,n.CI)({redirectTo:"/"})}catch(e){throw console.log(e),e}}(0,c.D)([j]),(0,s.A)(j,"7fd919d4267e3516d1ebfb2bae9c83eac9c99aecc3",null),(0,c.D)([w]),(0,s.A)(w,"0020711e683fce2295dcae5b03dba6b4bb1f7f7653",null)},52324:(e,r,t)=>{Promise.resolve().then(t.bind(t,54216)),Promise.resolve().then(t.bind(t,89061)),Promise.resolve().then(t.bind(t,99167)),Promise.resolve().then(t.bind(t,9797)),Promise.resolve().then(t.bind(t,50250)),Promise.resolve().then(t.bind(t,86382)),Promise.resolve().then(t.bind(t,32360))},17412:(e,r,t)=>{Promise.resolve().then(t.bind(t,39374)),Promise.resolve().then(t.bind(t,62890)),Promise.resolve().then(t.bind(t,40806)),Promise.resolve().then(t.bind(t,8089)),Promise.resolve().then(t.bind(t,87838)),Promise.resolve().then(t.bind(t,99318)),Promise.resolve().then(t.bind(t,55852))},699:(e,r,t)=>{"use strict";t.d(r,{A:()=>l});var s=t(45512),n=t(55852),a=t(58009);function l({users:e,takeUsers:r,closeModal:t,preSelectedUsers:l}){let[i,o]=(0,a.useState)(l??[]),[c,d]=(0,a.useState)(e),u=r=>{d(e.filter(e=>e.username?.toLowerCase().includes(r.toLowerCase())))},p=e=>{o(r=>r.includes(e)?r.filter(r=>r!==e):[...r,e])};return(0,s.jsxs)("div",{className:"w-full max-w-[320px] 4xl:max-w-[420px] h-[85vh] max-h-[700px] flex flex-col justify-between gap-2 p-4 rounded-xl border bg-light-cards dark:bg-dark-bg mx-2 mt-2",children:[(0,s.jsxs)("header",{className:"w-full",children:[(0,s.jsx)("p",{className:"text-2xl font-semibold mb-3",children:"Mes contactes"}),(0,s.jsx)("input",{type:"search",onChange:e=>u(e.target.value),placeholder:"Rechercher...",className:"newEventInput !bg-light-grey dark:!bg-transparent"})]}),(0,s.jsxs)("ul",{className:"flex flex-col w-full h-full no-scrollbar overflow-y-scroll inset-shadow-lg border border-light-borderCards dark:border-dark-borderCards rounded-lg p-2 bg-light-ciel dark:bg-dark-bg ",children:[0===c.length&&(0,s.jsx)("p",{className:"text-center opacity-50",children:"Aucun utilisateur trouv\xe9"}),c.map(e=>(0,s.jsxs)("li",{className:`cursor-pointer flex gap-2 bg-light-blue dark:bg-dark-cards items-end my-2 border-2 rounded-lg p-2 ${i.includes(e.id)?"border-light-yellow":"border-inherit"}`,onClick:()=>p(e.id),children:[(0,s.jsx)("div",{className:"shrink-1",children:(0,s.jsx)(n.UserAvatar,{src:e.image})}),(0,s.jsx)("span",{children:e.username})]},e.id))]}),(0,s.jsxs)("footer",{className:"flex flex-col gap-2 ",children:[(0,s.jsx)("button",{className:"primary-btn w-full",onClick:()=>{r(i)},children:"Confirmer"}),(0,s.jsx)("button",{className:"secondary-btn w-full",onClick:t,children:"Annuler"})]})]})}},87838:(e,r,t)=>{"use strict";t.d(r,{default:()=>i});var s=t(45512),n=t(35748),a=t(79334),l=t(58009);function i({title:e}){let r="",[t,i]=(0,l.useState)(!1),o=(0,a.useRouter)(),c=(0,a.useSearchParams)(),[d,u]=(0,l.useState)(c.get("search")||"");switch((0,l.useCallback)(e=>{let r=new URLSearchParams(c.toString());e?r.set("search",e):r.delete("search"),o.push(`?${r.toString()}`)},[c,o]),e){case"users":r="Un nom ? Une ville ?";break;case"events":r="mot cl\xe9, lieu, date ?";break;case"messages":r="Un conversation ? Un sujet ?";break;case"all":r="Un mot cl\xe9, un contact, une t\xe2che ?";break;default:r="Un mot cl\xe9 ?"}return(0,s.jsxs)("div",{className:"relative flex w-full max-w-[500px] overflow-visible",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 w-full",children:[(0,s.jsx)("input",{type:"search",value:d,onChange:e=>{u(e.target.value)},placeholder:r,className:"w-full h-10 p-5 text-xl placeholder:select-none dark:placeholder:text-dark-greenLight/50 border-2 border-dark-bg dark:bg-dark-bg dark:border-light-grey rounded-lg"}),(0,s.jsx)(n.In,{onClick:()=>i(!t),type:"search",width:40})]}),t&&(0,s.jsxs)("div",{className:"absolute select-none z-50 top-12 right-0 w-full dark:bg-dark-bg bg-light-blue border border-light-grey rounded-lg shadow-lg p-4",children:[(0,s.jsx)("h3",{className:"text-lg font-bold mb-4 text-light-grey",children:"Filtrer et Trier"}),(0,s.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"sort",className:"block text-sm text-light-grey mb-2",children:"Trier par"}),(0,s.jsxs)("select",{id:"sort",className:"newEventInput",children:[(0,s.jsx)("option",{value:"date",children:"Plus r\xe9cent"}),(0,s.jsx)("option",{value:"popularit\xe9",children:"Plus populaire"}),(0,s.jsx)("option",{value:"proximit\xe9",children:"Plus ancien"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"category",className:"text-sm text-light-grey mb-2 sm:hidden",children:"Cat\xe9gorie"}),(0,s.jsxs)("select",{id:"category",className:"newEventInput sm:hidden",children:[(0,s.jsx)("option",{value:"toutes",children:"Toutes les cat\xe9gories"}),(0,s.jsx)("option",{value:"culture",children:"Culture"}),(0,s.jsx)("option",{value:"sport",children:"Sport"}),(0,s.jsx)("option",{value:"\xe9ducation",children:"\xc9ducation"})]})]}),(0,s.jsx)("button",{onClick:()=>i(!1),className:"w-full p-2 bg-light-yellow text-dark-bg font-bold rounded-lg hover:bg-light-yellow/80",children:"Appliquer"})]})]})]})}},39374:(e,r,t)=>{"use strict";t.d(r,{default:()=>b});var s=t(45512),n=t(26248);let a=(0,n.createServerReference)("7f86c437f75ffeab4332bd128663d1faa33add1145",n.callServer,void 0,n.findSourceMapURL,"sendInvitationToEvent");var l=t(699),i=t(35748),o=t(99318),c=t(58009),d=t(91542);function u({children:e,color:r="primary",size:t="medium",outline:n=!1,rounded:a="pill",className:l="",onClick:i}){let o={primary:{bg:"bg-light-ciel dark:bg-dark-greenLight/70",text:"text-black dark:text-white",ring:"ring-2 ring-light-ciel dark:ring-dark-greenLight"},secondary:{bg:"bg-purple-100 dark:bg-purple-900/70",text:"text-purple-800 dark:text-purple-100",ring:"ring-2 ring-purple-500"},success:{bg:"bg-green-100 dark:bg-green-900/70",text:"text-green-800 dark:text-green-100",ring:"ring-2 ring-green-500"},warning:{bg:"bg-yellow-100 dark:bg-yellow-900/70",text:"text-yellow-800 dark:text-yellow-100",ring:"ring-2 ring-yellow-500"},error:{bg:"bg-red-100 dark:bg-red-900/70",text:"text-red-800 dark:text-red-100",ring:"ring-2 ring-red-500"},info:{bg:"bg-blue-100 dark:bg-blue-900/70",text:"text-blue-800 dark:text-blue-100",ring:"ring-2 ring-blue-500"}},c=n?`bg-transparent ${o[r].text} ${o[r].ring}`:`${o[r].bg} ${o[r].text}`;return(0,s.jsx)("div",{onClick:i,className:`inline-flex items-center font-[500] transition-all cursor-pointer ${{small:"px-2 py-0.5 text-xs",medium:"px-3 py-1 text-sm",large:"px-4 py-1.5 text-base"}[t]} ${{pill:"rounded-full",circle:"rounded-lg"}[a]} ${c} ${l}`,children:e})}var p=t(1617),m=t(40806);let f=(0,n.createServerReference)("7fd919d4267e3516d1ebfb2bae9c83eac9c99aecc3",n.callServer,void 0,n.findSourceMapURL,"deleteEvent");var x=t(55740);function h({text:e,loadingText:r,className:t}){let{pending:n}=(0,x.useFormStatus)();return(0,s.jsx)("button",{type:"submit",className:`primary-btn ${t}`,children:n?r:e})}var g=t(79334);function v({eventId:e,toggleModal:r}){let t=async r=>{r.preventDefault();try{await f({eventId:e}),d.o.success("\xc9v\xe9nement supprim\xe9 avec succ\xe8s")}catch(e){console.error(e)}(0,g.redirect)("/profile")};return(0,s.jsx)("div",{className:"absolute top-0 left-0 w-full h-full rounded-lg bg-black/90 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"flex flex-col gap-2 w-full text-center",children:[(0,s.jsx)("h1",{className:"font-bold text-2xl",children:"\xcates-vous s\xfbr de vouloir supprimer cet \xe9v\xe9nement ?"}),(0,s.jsx)("p",{className:"text-center text-lg font-extralight",children:"Cette action est irr\xe9versible."}),(0,s.jsxs)("form",{onSubmit:e=>t(e),className:"flex flex-wrap w-full justify-center gap-2",children:[(0,s.jsx)(h,{text:"Supprimer",loadingText:"Suppression...",className:"secondary-btn"}),(0,s.jsx)("button",{onClick:r,className:"primary-btn",children:"Non, annuler"})]})]})})}function b({event:e,contacts:r}){let[t,n]=(0,c.useState)(!1),[f,x]=(0,c.useState)(!1),[h,g]=(0,c.useState)(!1),b=function(e){let r=new Date;return Math.round((e.getTime()-r.getTime())/864e5)}(e.eventStart),j=e.tasks?.filter(e=>!e.completed),w=()=>{x(!f)},y=()=>{g(!h)},k=async r=>{let t=await a({eventId:e.id,participantsIds:r});t?.ok?d.o.success(t.message):d.o.error(t.message),y()};return(0,s.jsxs)("div",{className:"relative flex flex-col gap-2 justify-between w-full h-fit p-5 border border-dark-bg dark:border-light-grey rounded-lg bg-card",children:[(0,s.jsxs)("div",{className:"font-extralight text-lg flex flex-wrap items-center gap-5 select-none",children:[(0,s.jsx)("h1",{className:"font-bold text-2xl",children:e.title}),b>0?(0,s.jsx)(u,{color:"warning",onClick:()=>n(!t),children:(0,s.jsxs)("p",{children:[b," jours restants"]})}):(0,s.jsx)(u,{color:"info",onClick:()=>n(!t),children:(0,s.jsxs)("p",{children:["Passé il fait ",b," ",b>1?"jours":"jour"]})}),e.participants&&(0,s.jsxs)(u,{onClick:()=>n(!t),color:"success",children:[e.participants.length," ",e.participants.length>1?"participants":"participant"]}),(0,s.jsx)(u,{onClick:()=>n(!t),color:"error",children:(0,s.jsxs)("p",{children:[j?.length||0," t\xe2ches \xe0 accomplir"]})}),(0,s.jsx)("div",{className:"absolute right-5 top-7",children:t?(0,s.jsx)(i.In,{type:"minus",strokeWidth:3,onClick:()=>n(!1)}):(0,s.jsx)(i.In,{type:"plus",strokeWidth:3,onClick:()=>n(!0)})})]}),(0,s.jsxs)("div",{className:`overflow-hidden transition-all duration-500 ease-in-out ${t?"max-h-[500px] opacity-100":"max-h-0 opacity-0"}`,children:[(0,s.jsxs)("div",{className:"flex flex-wrap gap-2 mt-2 mb-5",children:[(0,s.jsx)(o.Link,{href:`/events/edit/${e.id}`,className:"primary-btn",children:"\xc9diter"}),(0,s.jsx)("button",{className:"primary-btn",onClick:()=>g(!0),children:"G\xe9rer les participants"}),(0,s.jsx)("button",{className:"secondary-btn",onClick:w,children:"Supprimer"})]}),(0,s.jsx)("div",{className:"flex justify-start items-center mb-10",children:(0,s.jsx)(p.default,{event:e})}),(0,s.jsx)(m.default,{tasks:e.tasks||[],eventId:e.id})]}),f&&(0,s.jsx)(v,{eventId:e.id,toggleModal:w}),h&&(0,s.jsx)("div",{className:"fixed z-[100] top-0 left-0 w-full h-full bg-black/80 flex justify-center items-center sm:pt-20",children:(0,s.jsx)(l.A,{users:r,takeUsers:k,closeModal:y,preSelectedUsers:e.participants?.map(e=>e.userId)})})]})}},62890:(e,r,t)=>{"use strict";t.d(r,{default:()=>l});var s=t(45512),n=t(26248);let a=(0,n.createServerReference)("0020711e683fce2295dcae5b03dba6b4bb1f7f7653",n.callServer,void 0,n.findSourceMapURL,"handleSignOut");t(58009);let l=()=>(0,s.jsx)("button",{className:"secondary-btn",onClick:()=>a(),children:"D\xe9connexion"})},40806:(e,r,t)=>{"use strict";t.d(r,{default:()=>P});var s=t(45512),n=t(26248);let a=(0,n.createServerReference)("7f18c30c8768a9e22fdb2c3dd272f2ab4d6f47def8",n.callServer,void 0,n.findSourceMapURL,"createTask"),l=(0,n.createServerReference)("7f79946f45de2eea1739a88c4620698c367ede93b0",n.callServer,void 0,n.findSourceMapURL,"deleteUserTask"),i=(0,n.createServerReference)("7fb44f0178c4951b568ad269ec66e74635f4a91807",n.callServer,void 0,n.findSourceMapURL,"updateTask");var o=t(35748),c=t(33967),d=t(58009);let u=(0,d.createContext)(null);var p=t(83229),m=t(15248),f=t(69641),x=t(57376);let h=(0,d.forwardRef)(function({children:e,as:r="ul",axis:t="y",onReorder:n,values:a,...l},i){let o=(0,m.M)(()=>p.P[r]),h=[],b=(0,d.useRef)(!1);return(0,c.V)(!!a,"Reorder.Group must be provided a values prop"),(0,s.jsx)(o,{...l,ref:i,ignoreStrict:!0,children:(0,s.jsx)(u.Provider,{value:{axis:t,registerItem:(e,r)=>{let s=h.findIndex(r=>e===r.value);-1!==s?h[s].layout=r[t]:h.push({value:e,layout:r[t]}),h.sort(v)},updateOrder:(e,r,t)=>{if(b.current)return;let s=function(e,r,t,s){if(!s)return e;let n=e.findIndex(e=>e.value===r);if(-1===n)return e;let a=s>0?1:-1,l=e[n+a];if(!l)return e;let i=e[n],o=l.layout,c=(0,x.k)(o.min,o.max,.5);return 1===a&&i.layout.max+t>c||-1===a&&i.layout.min+t<c?(0,f.Pe)(e,n,n+a):e}(h,e,r,t);h!==s&&(b.current=!0,n(s.map(g).filter(e=>-1!==a.indexOf(e))))}},children:e})})});function g(e){return e.value}function v(e,r){return e.layout.min-r.layout.min}var b=t(17810),j=t(55785);function w(e){let r=(0,m.M)(()=>(0,b.OQ)(e)),{isStatic:t}=(0,d.useContext)(j.Q);if(t){let[,t]=(0,d.useState)(e);(0,d.useEffect)(()=>r.on("change",t),[])}return r}var y=t(24455);let k=e=>e&&"object"==typeof e&&e.mix,N=e=>k(e)?e.mix:void 0;var C=t(13607),A=t(13699);function S(e,r){let t=w(r()),s=()=>t.set(r());return s(),(0,C.E)(()=>{let r=()=>A.Gt.preRender(s,!1,!0),t=e.map(e=>e.on("change",r));return()=>{t.forEach(e=>e()),(0,A.WG)(s)}}),t}function R(e,r){let t=(0,m.M)(()=>[]);return S(e,()=>{t.length=0;let s=e.length;for(let r=0;r<s;r++)t[r]=e[r].get();return r(t)})}var I=t(82563);function U(e,r=0){return(0,I.S)(e)?e:w(r)}let D=(0,d.forwardRef)(function({children:e,style:r={},value:t,as:n="li",onDrag:a,layout:l=!0,...i},o){let f=(0,m.M)(()=>p.P[n]),x=(0,d.useContext)(u),h={x:U(r.x),y:U(r.y)},g=function(e,r,t,s){if("function"==typeof e)return function(e){b.bt.current=[],e();let r=S(b.bt.current,e);return b.bt.current=void 0,r}(e);let n="function"==typeof r?r:function(...e){let r=!Array.isArray(e[0]),t=r?0:-1,s=e[0+t],n=e[1+t],a=e[2+t],l=e[3+t],i=(0,y.G)(n,a,{mixer:N(a[0]),...l});return r?i(s):i}(r,void 0,void 0);return Array.isArray(e)?R(e,n):R([e],([e])=>n(e))}([h.x,h.y],([e,r])=>e||r?1:"unset");(0,c.V)(!!x,"Reorder.Item must be a child of Reorder.Group");let{axis:v,registerItem:j,updateOrder:w}=x;return(0,s.jsx)(f,{drag:v,...i,dragSnapToOrigin:!0,style:{...r,x:h.x,y:h.y,zIndex:g},layout:l,onDrag:(e,r)=>{let{velocity:s}=r;s[v]&&w(t,h[v].get(),s[v]),a&&a(e,r)},onLayoutMeasure:e=>j(t,e),ref:o,ignoreStrict:!0,children:e})});function P({tasks:e,eventId:r}){let[t,n]=(0,d.useState)(e),[c,u]=(0,d.useState)(null),[p,m]=(0,d.useState)(""),f=(0,d.useRef)(null),x=(0,d.useRef)(null),g=(0,d.useRef)([]),v=async e=>{if(!e)return;let r=await l(e);r?.ok&&n(t.filter(r=>r.id!==e))},b=async()=>{if(!c)return;if(0===p.length){await v(c.id);return}let e={...c,content:p.trim()};try{(await i(e)).ok&&n(t.map(r=>r.id===e.id?e:r))}catch(e){console.error(e)}},j=async(e,r)=>{if(!r||!r.content)return;let s={...r,completed:e.target.checked};try{await i(s),n(t.map(e=>e.id===s.id?s:e))}catch(e){console.error(e)}},w=async e=>{e.preventDefault();let s=new FormData(e.currentTarget).get("content");if(0===s.length)return;let l=t.map((e,r)=>(e.order=r+1,e)),i=await a({content:s,completed:!1,eventId:r||null});i?.ok&&(n([i.newTask,...l]),e.target.reset(),x.current&&(x.current.style.width="100%"))},y=(e,r)=>{if("number"==typeof r){let s=[...t];s[r]={...s[r],content:e.target.value},n(s);let a=g.current[r];a&&(a.style.height="10px",a.style.height=`${a.scrollHeight+1}px`)}else x.current&&(x.current.style.height="10px",x.current.style.height=`${x.current.scrollHeight+1}px`);m(e.target.value)},k=e=>{if("Enter"===e.key){e.preventDefault();let r=e.currentTarget.closest("form");r&&r.requestSubmit()}},N=async()=>{try{for(let e of t)await i(e)}catch(e){console.error("Error al actualizar el orden de las tareas",e)}},C=async e=>{n(e.map((e,r)=>({...e,order:r+1})))};return(0,s.jsxs)("div",{className:"w-full flex flex-col items-center flex-wrap sm:!items-start",children:[(0,s.jsx)("form",{onSubmit:e=>w(e),className:"flex items-end gap-5 mb-2 w-full",children:(0,s.jsxs)("div",{className:"flex w-full gap-5",children:[(0,s.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,s.jsx)(o.In,{className:"hover:text-red-600 dark:hover:text-dark-greenLight hover:scale-110",type:"menu",width:35}),(0,s.jsx)("button",{"aria-label":"Ajouter une t\xe2che",children:(0,s.jsx)(o.In,{type:"add",className:"hover:text-red-600 dark:hover:text-dark-greenLight hover:scale-110",width:35})})]}),(0,s.jsx)("textarea",{ref:x,name:"content",placeholder:"Nouvelle t\xe2che",autoComplete:"off",className:"resize-none no-scrollbar w-[90%] bg-transparent ml-2 border-b focus:outline-none border-dark-bg dark:border-light-grey placeholder:text-black/50 placeholder:dark:text-dark-greenLight/50",onChange:e=>y(e),onKeyDown:e=>k(e)})]})}),(0,s.jsx)("form",{ref:f,className:"w-full select-none",children:(0,s.jsx)(h,{axis:"y",values:t,onReorder:C,children:t?.map((e,r)=>s.jsxs(D,{value:e,onDragEnd:N,className:"flex gap-2 items-center mt-1",children:[s.jsx(o.In,{onClick:()=>v(e.id),type:"delete",className:"hover:text-red-600 dark:hover:text-dark-greenLight hover:scale-110"}),s.jsx(o.In,{type:"draggable",className:"!cursor-grab"}),s.jsx("input",{"aria-label":"task-checkbox",autoComplete:"off",className:"peer",type:"checkbox",defaultChecked:!!e.completed,onChange:r=>j(r,e)}),s.jsx("textarea",{rows:1,ref:e=>{e&&(g.current[r]=e)},className:"no-scrollbar resize-none w-full h-10px bg-transparent ml-2 my-1 border-b border-dark-bg dark:border-light-grey/50 focus:outline-none peer-checked:line-through decoration-2 decoration-light-red placeholder:text-light-blue placeholder:dark:text-dark-greenLight/50",onFocus:r=>{u(e),m(r.target.value)},onChange:e=>y(e,r),onBlur:b,onKeyDown:e=>k(e),defaultValue:e.content,placeholder:"..."})]},e.id))})})]})}},76752:(e,r,t)=>{"use strict";t.d(r,{v:()=>l});var s=t(79748),n=t(33873),a=t.n(n);async function l(e){let r=a().join(process.cwd(),"public",e);try{await (0,s.unlink)(r)}catch(e){throw console.error("Error deleting the image:",e),Error("Erreur lors de la suppression de l'image")}}},4858:(e,r,t)=>{"use strict";t.d(r,{K:()=>a});var s=t(39290),n=t(2121);let a=async e=>{let r=await (0,s.j2)();if(!r)return console.error("selectAllBasicUserInfos: no session found"),[];try{let t=await (0,n.ZR)();if(!t)return[];if(!e)return t.filter(e=>e.id!==r?.user?.id&&null!==e.username&&null!==e.email&&null!==e.image&&null!==e.description);return t.filter(r=>!!(r.username?.toLowerCase().includes(e.toLowerCase())||r.email?.toLowerCase().includes(e.toLowerCase())))}catch(e){return console.error(e),[]}}},96700:(e,r,t)=>{"use strict";t.d(r,{A:()=>i});var s=t(88977);t(98063);var n=t(39290),a=t(2121),l=t(11527);async function i(){let e=await (0,n.j2)();if(!e||!e.user?.id)return null;try{let r=await (0,a.Vg)({id:e.user.id});if(!r)return null;return(0,l.M)(r)}catch(e){return console.error("Error in selectProfileData:",e),null}}(0,t(56215).D)([i]),(0,s.A)(i,"00fd58976968bd360b0b51da2c89d0ff02e76d2f2c",null)},21762:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>g});var s=t(62740),n=t(4858),a=t(96700),l=t(70068),i=t(23088),o=t(54216),c=t(97214),d=t(89061),u=t(99167),p=t(9797),m=t(42715),f=t(32360),x=t(86382),h=t(31831);t(76301);let g=async()=>{let e=await (0,a.A)();e||(0,h.redirect)("/login");let r=await (0,n.K)(),{description:t,username:g,email:v,image:b,comments:j,eventsCreated:w,eventsJoined:y,tasks:k,score:N}=e;return(0,s.jsxs)("section",{className:"min-h-screen mt-10 relative px-2 w-full max-w-max mx-auto flex flex-col sm:!flex-row justify-start gap-5 divide-light-borderCards dark:divide-dark-borderCards divide-y sm:divide-y-0 sm:divide-x ",children:[(0,s.jsx)("aside",{className:"w-full sm:sticky top-24 max-w-[400px] h-fit p-5 flex justify-center",children:(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center pt-5 gap-2",children:[(0,s.jsx)(d.default,{}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(x.Link,{"aria-label":"\xc9diter profile",href:"/profile/edition",children:(0,s.jsx)(p.default,{type:"edit",strokeWidth:2,className:"hover:scale-110 hover:dark:text-dark-greenLight transition-all ease-in-out absolute bottom-2 right-[-10px]"})}),(0,s.jsx)(f.UserAvatar,{src:b,className:"size-[200px]"})]}),(0,s.jsx)("h1",{className:"font-bold text-2xl",children:g||v}),(0,s.jsx)(m.A,{ranting:N}),(0,s.jsx)("h2",{className:"font-bold text-2xl",children:"Bio"}),t&&t.length>0?(0,s.jsx)("p",{className:"text-balance text-center mx-auto",children:t}):(0,s.jsx)("div",{className:"h-[200px] flex items-center justify-center p-2 border-2 border-dark-bg dark:border-white bg-dark-grey/40 rounded-xl",children:(0,s.jsx)("p",{className:"text-center",children:"Il semble que tu n'aies pas encore ajout\xe9 ta bio ! Prends un moment pour compl\xe9ter ton profil et acc\xe9der \xe0 toutes les fonctionnalit\xe9s de l'application. Nous avons h\xe2te de mieux te conna\xeetre !"})})]})}),(0,s.jsxs)("main",{className:"flex flex-col w-full text-center sm:text-left gap-5 lg:gap-10 pb-10 px-2 sm:px-5",children:[(0,s.jsxs)("header",{children:[(0,s.jsx)(l.A,{title:"Mon profil",searchType:"all"}),(0,s.jsx)("div",{children:(0,s.jsx)("h1",{className:"font-bold text-2xl",children:"Mes notes"})})]}),(0,s.jsx)(u.default,{tasks:k}),(0,s.jsxs)("div",{className:"flex flex-col gap-5 w-full ",children:[(0,s.jsxs)("div",{className:"flex w-full justify-between flex-wrap gap-2",children:[(0,s.jsx)("h1",{className:"font-bold text-2xl",children:"Mes \xe9v\xe9nements cr\xe9es"}),(0,s.jsx)(x.Link,{className:"primary-btn",href:"/events/new",children:"Creer un \xe9v\xe9nement \uD83D\uDCC5"})]}),w?.length===0?(0,s.jsx)("p",{className:"opacity-50",children:"Vous n'avez pas encore cr\xe9\xe9 d'\xe9v\xe9nement"}):w.map(e=>(0,s.jsx)(o.default,{event:e,contacts:r},e.id)),(0,s.jsxs)("div",{className:"flex w-full justify-between flex-wrap gap-2",children:[(0,s.jsx)("h1",{className:"font-bold text-2xl",children:"Mes \xe9v\xe9nements \xe0 venir"}),(0,s.jsx)(x.Link,{className:"primary-btn",href:"/events",children:"D\xe9couvrir les \xe9v\xe9nements \uD83D\uDE80"})]}),y?.length===0?(0,s.jsx)("div",{children:(0,s.jsx)("p",{className:"opacity-50",children:"Vous n'avez pas encore rejoint des \xe9v\xe9nements"})}):y.map(e=>(0,s.jsx)(c.A,{event:e,category:e.category},e.id)),(0,s.jsx)("h1",{className:"font-bold text-2xl",children:"Mes avis"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-5 w-full ",children:j?.length>0?j?.map(e=>s.jsx(i.A,{comment:e},e.id)):(0,s.jsx)("p",{className:"opacity-50",children:"Aucun avis pour le moment"})})]})]})]})}},70068:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});var s=t(62740),n=t(50250);function a({title:e,searchType:r}){return(0,s.jsxs)("div",{className:"relative z-20 flex flex-col gap-5 w-[95%] mx-auto mb-5 4xl:mb-10 4xl:mt-20 flex-wrap overflow-visible",children:[(0,s.jsx)("h1",{className:"text-4xl font-bold text-light-borderCards dark:text-light-grey",children:e}),(0,s.jsx)(n.default,{title:r})]})}},50250:(e,r,t)=>{"use strict";t.d(r,{default:()=>s});let s=(0,t(46760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\User\\\\Documents\\\\Hi world\\\\ADRAR 2024\\\\Fil Rouge\\\\components\\\\ui\\\\SearchBar.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\User\\Documents\\Hi world\\ADRAR 2024\\Fil Rouge\\components\\ui\\SearchBar.tsx","default")},23088:(e,r,t)=>{"use strict";t.d(r,{A:()=>i});var s=t(62740),n=t(32360),a=t(86382),l=t(42715);function i({comment:e}){return(0,s.jsxs)("div",{className:"flex flex-col gap-2 p-1 border-2 border-card rounded-lg w-full max-w-[280px]",children:[(0,s.jsxs)("div",{className:"flex items-center gap-5 p-2  border-b w-full",children:[(0,s.jsx)(a.Link,{href:`/communaute/profile/${e.author.id}`,children:(0,s.jsx)(n.UserAvatar,{src:e.author.image,className:"size-12"})}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("p",{className:"text-lg font-semibold",children:e.author.username}),(0,s.jsx)("p",{className:"text-sm font-thin",children:e.createdAt.toLocaleDateString()})]})]}),(0,s.jsxs)("div",{className:"text-lg pl-2",children:[(0,s.jsx)(l.A,{starWidth:15,ranting:e.rating?.score||0}),(0,s.jsx)("p",{children:e.content})]})]},e.id)}},54216:(e,r,t)=>{"use strict";t.d(r,{default:()=>s});let s=(0,t(46760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\User\\\\Documents\\\\Hi world\\\\ADRAR 2024\\\\Fil Rouge\\\\components\\\\ui\\\\cards\\\\OwnerEventCard.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\User\\Documents\\Hi world\\ADRAR 2024\\Fil Rouge\\components\\ui\\cards\\OwnerEventCard.tsx","default")},97214:(e,r,t)=>{"use strict";t.d(r,{A:()=>l});var s=t(62740),n=t(32360),a=t(86382);async function l({category:e,event:r}){return console.log({event:r}),(0,s.jsx)(a.Link,{href:`/events/event/${r.id}`,className:"group relative w-[300px] flex borde  r border-card rounded-lg p-5 pb-10 gap-2 flex-col overflow-hidden bg-card",children:(0,s.jsxs)("div",{className:"h-full flex flex-col justify-between",children:[(0,s.jsx)("div",{className:"flex justify-between ",children:(0,s.jsxs)("h1",{className:"font-bold text-xl text-wrap",children:[r.title," ",(0,s.jsxs)("span",{className:"text-sm font-thin",children:[" - ",e.title]})]})}),(0,s.jsxs)("div",{className:"",children:[(0,s.jsxs)("p",{className:"text-sm mb-2",children:[r._count?.participants," participants"]}),(0,s.jsxs)("p",{className:"text-sm",children:["D\xe9but le : ",r.eventStart.toLocaleDateString()," a"," ",r.eventStart.toLocaleTimeString()]}),r.eventEnd&&(0,s.jsxs)("p",{className:"text-sm",children:["Termine le : ",r.eventEnd.toLocaleDateString()," a"," ",r.eventEnd.toLocaleTimeString()]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 my-2",children:[(0,s.jsx)(n.UserAvatar,{src:r.creator?.image}),(0,s.jsx)("div",{children:(0,s.jsxs)("p",{className:"text-sm",children:["Cree par ",r.creator?.username]})})]}),(0,s.jsx)("p",{className:"text-sm text-balance break-words line-clamp-3",children:r.description})]})})}t(76301)},89061:(e,r,t)=>{"use strict";t.d(r,{default:()=>n});var s=t(46760);(0,s.registerClientReference)(function(){throw Error("Attempted to call SignOutButton() from the server but SignOutButton is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\User\\Documents\\Hi world\\ADRAR 2024\\Fil Rouge\\components\\ui\\dashboard\\SignOutButton.tsx","SignOutButton");let n=(0,s.registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\User\\\\Documents\\\\Hi world\\\\ADRAR 2024\\\\Fil Rouge\\\\components\\\\ui\\\\dashboard\\\\SignOutButton.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\User\\Documents\\Hi world\\ADRAR 2024\\Fil Rouge\\components\\ui\\dashboard\\SignOutButton.tsx","default")},99167:(e,r,t)=>{"use strict";t.d(r,{default:()=>s});let s=(0,t(46760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\User\\\\Documents\\\\Hi world\\\\ADRAR 2024\\\\Fil Rouge\\\\components\\\\ui\\\\dashboard\\\\TasksProfile.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\User\\Documents\\Hi world\\ADRAR 2024\\Fil Rouge\\components\\ui\\dashboard\\TasksProfile.tsx","default")},26490:(e,r,t)=>{"use strict";t.d(r,{Rg:()=>n,_g:()=>a});var s=t(40492);let n=async({title:e,eventId:r})=>{try{let t={title:e};return r&&(t.eventId=r),await s.A.conversation.create({data:t})}catch(e){throw console.error("createConversationService: error",e),Error("Service error: createConversationService")}},a=async e=>{try{let r=(await s.A.message.findMany({where:{conversationId:e},select:{id:!0}})).map(e=>e.id);await s.A.$transaction([s.A.messageStatus.deleteMany({where:{messageId:{in:r}}}),s.A.message.deleteMany({where:{conversationId:e}}),s.A.userConversation.deleteMany({where:{conversationId:e}}),s.A.conversation.delete({where:{id:e}})])}catch(e){throw console.error("deleteConversationService: error",e),Error("Service error: deleteConversationService")}}},2121:(e,r,t)=>{"use strict";t.d(r,{Vg:()=>a,ZR:()=>n});var s=t(11587);let n=async()=>{try{return await s.A.user.findMany({select:{id:!0,email:!0,username:!0,image:!0,description:!0,_count:{select:{Ratings:!0,EventsCreated:!0}}}})}catch(e){return console.error("selectAllUsersService",e),null}},a=async({id:e})=>{if(!e||"string"!=typeof e)return null;try{let r=await s.A.user.findUnique({where:{id:e},select:{id:!0,email:!0,username:!0,image:!0,description:!0,EventsCreated:{select:{id:!0,title:!0,description:!0,eventStart:!0,eventEnd:!0,isPublic:!0,image:!0,createdAt:!0,updatedAt:!0,formattedAddress:!0,conversation:{select:{id:!0}},participants:{select:{userId:!0}},category:{select:{id:!0,title:!0}},UserInvitations:!0,Tasks:!0},orderBy:{eventStart:"asc"}},EventsJoined:{select:{event:{select:{id:!0,title:!0,description:!0,user:{select:{id:!0,username:!0,image:!0}},eventStart:!0,eventEnd:!0,isPublic:!0,image:!0,createdAt:!0,updatedAt:!0,formattedAddress:!0,conversation:{select:{id:!0}},category:{select:{id:!0,title:!0}},_count:{select:{participants:!0}}}}}},Tasks:!0,CommentsReceived:{select:{id:!0,createdAt:!0,updatedAt:!0,content:!0,recipientId:!0,author:{select:{id:!0,username:!0,image:!0}},rating:{select:{score:!0}}}}}});if(!r)return null;return r}catch(e){return console.error("selectUserDataService",e),null}}},11527:(e,r,t)=>{"use strict";t.d(r,{M:()=>s});let s=e=>{let r=e.CommentsReceived.length,t=e.CommentsReceived.reduce((e,r)=>e+(r.rating?.score||0),0);return{id:e.id,email:e.email,username:e.username,image:e.image,description:e.description,eventsCreated:e.EventsCreated,eventsJoined:e.EventsJoined.map(({event:e})=>({...e,creator:e.user})),tasks:e.Tasks,comments:e.CommentsReceived,score:r>0?t/r:0}}}};var r=require("../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[87,895,671,103,229,899,683,335],()=>t(12766));module.exports=s})();