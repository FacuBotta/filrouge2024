exports.id=972,exports.ids=[972],exports.modules={25234:(e,r,a)=>{"use strict";a.r(r),a.d(r,{"00f94856f1c5a9ac8a10eda633022e6d6339640612":()=>p,"404b1a5e1efc6751d1600e2d8b53a2ca3b4a3f7692":()=>m,"7f192bb243ae0392eb275de385ac2bfa5bfdf4eeaf":()=>c});var s=a(21590);a(70376);var t=a(45795),n=a(33582),o=a(43567),i=a(67611),l=a(99344);let c=async e=>{let r=e.get("email"),a=e.get("password");try{t.y4.parse({email:r});let e=await (0,i.A)(r);if(!e)return{ok:!1,typeError:"email",message:"Cet email n'est pas associ\xe9 \xe0 un compte"};if(!await (0,o.O)({inputPassword:a,hashedPassword:e.password}))return{ok:!1,typeError:"password",message:"Mot de passe incorrect"};let s={id:e.id,role:e.role,hasPassword:e.hasPassword||null,email:e.email};return await (0,n.Jv)("credentials",s),{ok:!0,message:"Connexion r\xe9ussie"}}catch(e){return console.error("error in handleCredentialsSignIn",e),{ok:!1,message:"Une erreur est survenue, veuillez r\xe9essayer"}}};(0,l.D)([c]),(0,s.A)(c,"7f192bb243ae0392eb275de385ac2bfa5bfdf4eeaf",null);var d=a(80956),u=a(17038);async function m(e){try{if(t.y4.parse({email:e}),await (0,u.cT)({email:e}))return{ok:!1,message:"Un compte existe d\xe9j\xe0 avec cet email"};return await (0,n.Jv)("nodemailer",{email:e,callbackUrl:"/profile",redirect:!1}),{ok:!0,message:"Email envoy\xe9"}}catch(e){return(0,d.H)(e)}}async function p(){try{await (0,n.Jv)("google",{redirectTo:"/profile"})}catch(e){throw console.error("Error during Google Sign-In:",e),e}}(0,l.D)([m]),(0,s.A)(m,"404b1a5e1efc6751d1600e2d8b53a2ca3b4a3f7692",null),(0,l.D)([p]),(0,s.A)(p,"00f94856f1c5a9ac8a10eda633022e6d6339640612",null)},14817:(e,r,a)=>{"use strict";a.r(r),a.d(r,{"7fe13f6264349238c6e48141c1e4a57ee047053936":()=>s.Y});var s=a(53337)},29089:(e,r,a)=>{Promise.resolve().then(a.bind(a,47152)),Promise.resolve().then(a.bind(a,23104))},42241:(e,r,a)=>{Promise.resolve().then(a.bind(a,35354)),Promise.resolve().then(a.bind(a,20124))},35354:(e,r,a)=>{"use strict";a.d(r,{default:()=>v});var s=a(45512),t=a(26248);let n=(0,t.createServerReference)("7f192bb243ae0392eb275de385ac2bfa5bfdf4eeaf",t.callServer,void 0,t.findSourceMapURL,"CredentialsLoginServerAction"),o=(0,t.createServerReference)("404b1a5e1efc6751d1600e2d8b53a2ca3b4a3f7692",t.callServer,void 0,t.findSourceMapURL,"emailSignInServerAction"),i=(0,t.createServerReference)("00f94856f1c5a9ac8a10eda633022e6d6339640612",t.callServer,void 0,t.findSourceMapURL,"handleGoogleSignIn");var l=a(13645),c=a(74490),d=a(95226),u=a(35748),m=a(99318),p=a(79334),g=a(58009),f=a(24109);function v(){let e=(0,p.useRouter)(),[r,a]=(0,g.useState)("Sign-In"),[t,v]=(0,g.useTransition)(),[h,b]=(0,g.useState)(!1),[x,w]=(0,g.useState)(!1),[y,S]=(0,g.useState)({mail:{message:"",value:!1},password:{message:"",value:!1},conditions:{message:"",value:!1}}),k=async e=>{e.preventDefault(),S({mail:{message:"",value:!1},password:{message:"",value:!1},conditions:{message:"",value:!1}});let r=new FormData(e.currentTarget);try{let e=(0,d.h)(r,"email"),a=(0,d.h)(r,"password");c.y4.parse({email:e}),c.$w.parse({password:a}),console.log({email:e,password:a});let s=await n(r);s?.ok||S(e=>({...e,mail:s?.typeError==="email"?{message:s.message,value:!0}:e.mail,password:s?.typeError==="password"?{message:s.message,value:!0}:e.password}))}catch(e){e instanceof Error&&S(e=>({...e,mail:{message:"Une erreur est survenue, veuillez r\xe9essayer",value:!0}}))}},j=async()=>{try{await i()}catch(e){console.error(e)}};return(0,s.jsx)(s.Fragment,{children:h?(0,s.jsxs)("div",{id:"success-modal",className:"relative flex flex-col text-center items-center gap-3 w-full max-w-md p-5 mx-2 bg-light-blue border rounded-lg border-light-yellow dark:bg-dark-bg",children:[(0,s.jsx)("h3",{className:"text-4xl font-bold mb-5",children:"Mail envoy\xe9 !"}),(0,s.jsx)("p",{className:"text-lg",children:"V\xe9rifie ton e-mail pour activer ton compte."}),(0,s.jsx)("p",{children:"Tu peux fermer cette page."})]}):(0,s.jsxs)("form",{className:"primary-form",onSubmit:"Sign-Up"===r?e=>{if(e.preventDefault(),S({mail:{message:"",value:!1},password:{message:"",value:!1},conditions:{message:"",value:!1}}),!x){S({...y,conditions:{message:"Veuillez accepter les conditions d'utilisation",value:!0}});return}try{let r=new FormData(e.currentTarget),a=(0,d.h)(r,"email");c.y4.parse({email:a}),v(async()=>{let e=await o(a);e?.ok?e.ok&&b(!0):S({...y,mail:{message:e?.message,value:!0}})})}catch(r){let e=(0,l.H)(r);console.log({handledError:e}),S(r=>({...r,mail:{message:e.message,value:!0}}))}}:k,children:[(0,s.jsx)(u.In,{type:"plus",strokeWidth:2,onClick:()=>e.back(),className:"absolute right-[10px] top-[10px] cursor-pointer rotate-45"}),(0,s.jsx)("h2",{className:"text-2xl mb-3 font-bold text-center",children:"Sign-In"===r?"Content de te revoir !":"Bienvenue sur EventHub !"}),(0,s.jsx)(u.pd,{className:"primary-input",required:!0,label:"Sign-In"===r?"Email":"On va t'envoyer un mail de confirmation !",type:"email",id:"Email",name:"email",placeholder:"Email",disabled:t,autoComplete:"email",error:{message:y.mail?.message,value:y.mail?.value}}),"Sign-In"===r?(0,s.jsx)(u.pd,{className:"bg-light-grey dark:bg-dark-bg border-[1px] rounded-lg p-2 border-light-blue dark:border-dark-grey focus:border-light-yellow focus:dark:border-light-yellow",required:!0,label:"Mot de passe",type:"password",name:"password",placeholder:"Password",disabled:t,autoComplete:"current-password",error:{message:y.password?.message,value:y.password?.value}}):(0,s.jsxs)("div",{className:"self-start text-sm",children:[(0,s.jsxs)("label",{htmlFor:"terms",className:"flex gap-2",children:[(0,s.jsx)("input",{type:"checkbox",name:"terms",id:"terms",checked:x,onChange:()=>w(!x)}),"J'accepte les"," ",(0,s.jsx)(m.Link,{href:"/about",className:"underline",children:"Conditions d'utilisation"})]}),y.conditions?.value&&!x&&(0,s.jsx)("span",{className:"text-[red] text-[1rem]",children:y.conditions?.message})]}),(0,s.jsx)(f.A,{width:"100%",type:"submit",children:"Sign-In"===r?"Se connecter":t?"Envoi du mail...":"S'inscrire"}),"Sign-In"===r&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("p",{className:"mt-4 text-[1rem] select-none cursor-pointer hover:underline",onClick:()=>j(),children:["Ou initier avec votre compte ",(0,s.jsx)("strong",{children:"Google"})]}),(0,s.jsx)("p",{className:"text-[1rem] select-none cursor-pointer hover:underline",children:"Mot de passe oubli\xe9 ?"})]}),(0,s.jsx)("p",{id:"toggle-form",className:"text-[1rem] mt-1 cursor-pointer select-none hover:underline",onClick:()=>a("Sign-In"===r?"Sign-Up":"Sign-In"),children:"Sign-Up"===r?"Tu as d\xe9j\xe0 un compte ?":"Tu n'as pas encore de compte ?"})]})})}},24109:(e,r,a)=>{"use strict";a.d(r,{A:()=>t});var s=a(45512);function t({onClick:e,width:r,children:a,type:t}){return(0,s.jsx)("button",{type:t||"button",style:{width:r||"fit-content"},onClick:e,className:"inline-flex items-center justify-center px-4 py-1 border-2 text-lg rounded-lg bg-light-yellow text-dark-bg font-bold border-dark-bg hover:shadow-lg  transition-transform duration-300 ease-in-out ",children:a})}a(58009)},13645:(e,r,a)=>{"use strict";a.d(r,{H:()=>n});class s extends Error{constructor(e,r){super(e),this.name=this.constructor.name,this.ok=!1,this.message=e,this.errors=r}}var t=a(16131);function n(e){if(e instanceof t.G){let r=e.errors.map(({message:e,path:r})=>({message:e,path:r}));return new s(r.map(e=>e.message).join(", "),r)}return new s("Une erreur est survenue")}},43567:(e,r,a)=>{"use strict";a.d(r,{O:()=>c});var s=a(21590);a(70376);var t=a(45795),n=a(5486),o=a.n(n),i=a(67611),l=a(99344);let c=async({inputPassword:e,hashedPassword:r,email:a})=>{try{if(r)return await o().compare(e,r);if(!r&&a){t.y4.parse({email:a});let r=await (0,i.A)(a);if(!r?.password)return!1;let s=r.password;return await o().compare(e,s)}return!1}catch(e){return console.error("Error al verificar la contrase\xf1a:",e),!1}};(0,l.D)([c]),(0,s.A)(c,"7faaecf046cb5b8d941bfcfad4c2bd225f09d86dba",null)},67611:(e,r,a)=>{"use strict";a.d(r,{A:()=>n});var s=a(21590);a(70376);var t=a(17038);async function n(e){try{return await (0,t.cT)({email:e})}catch(e){return console.log(e),null}}(0,a(99344).D)([n]),(0,s.A)(n,"40b80a991cc8f7c1cc7ee98d4d6ab0d55315e6e3e4",null)},47152:(e,r,a)=>{"use strict";a.d(r,{default:()=>s});let s=(0,a(46760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\User\\\\Documents\\\\Hi world\\\\ADRAR 2024\\\\Fil Rouge\\\\components\\\\forms\\\\LogForm.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\User\\Documents\\Hi world\\ADRAR 2024\\Fil Rouge\\components\\forms\\LogForm.tsx","default")},80956:(e,r,a)=>{"use strict";a.d(r,{H:()=>n});class s extends Error{constructor(e,r){super(e),this.name=this.constructor.name,this.ok=!1,this.message=e,this.errors=r}}var t=a(16500);function n(e){if(e instanceof t.G){let r=e.errors.map(({message:e,path:r})=>({message:e,path:r}));return new s(r.map(e=>e.message).join(", "),r)}return new s("Une erreur est survenue")}}};