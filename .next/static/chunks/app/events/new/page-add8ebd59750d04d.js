(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3515],{933:(e,t,a)=>{Promise.resolve().then(a.bind(a,3425))},3425:(e,t,a)=>{"use strict";a.d(t,{NewEventPage:()=>x});var l=a(5155),r=a(5828);let s=(0,r.createServerReference)("7f238c1258a29ee39d5f388db219007640a62450c7",r.callServer,void 0,r.findSourceMapURL,"createEvent");var n=a(2085),i=a(6583),d=a(1108),o=a(7490),c=a(6046),u=a(2115),m=a(814),g=a(3415);let x=e=>{var t,a,r,x,p,v,f,b,h,j,y,w;let{availableCategories:N,contacts:z}=e,[k,E]=(0,u.useState)({title:{message:"",value:!1},category:{message:"",value:!1},eventStart:{message:"",value:!1},eventEnd:{message:"",value:!1},description:{message:"",value:!1},address:{message:"",value:!1},image:{message:"",value:!1}}),S=(0,c.useRouter)(),C=(0,u.useRef)(null),[D,A]=(0,u.useState)(null),[L,R]=(0,u.useState)(null),[_,I]=(0,u.useState)(!1),[P,M]=(0,u.useState)([]),F=()=>{if(E({...k,image:{message:"",value:!1}}),R(""),C.current){var e;let t=null===(e=C.current.files)||void 0===e?void 0:e[0];if(t){if(t.size>2e6){E({...k,image:{message:"La taille du fichier d\xe9passe 2Mo !",value:!0}}),C.current.value="";return}if(t){let e=new FileReader;e.onload=e=>{var t;R(null===(t=e.target)||void 0===t?void 0:t.result)},e.readAsDataURL(t)}}}},U=async e=>{if(e.preventDefault(),E({title:{message:"",value:!1},category:{message:"",value:!1},eventStart:{message:"",value:!1},eventEnd:{message:"",value:!1},description:{message:"",value:!1},address:{message:"",value:!1},image:{message:"",value:!1}}),!D){E({...k,address:{message:"Ubication obligatoire",value:!0}});return}let t=new FormData(e.currentTarget),a="on"===t.get("endSameDay");if(!a&&""===t.get("eventEnd")){E({...k,eventEnd:{message:"La date de fin est obligatoire",value:!0}});return}if(console.log(t.get("category")),"Cat\xe9gorie"===t.get("category")){E({...k,category:{message:"La cat\xe9gorie est obligatoire",value:!0}});return}let l={title:t.get("title"),categoryId:t.get("category"),isPublic:"on"===t.get("isPublic"),image:t.get("image"),eventStart:new Date(t.get("eventStart")),eventEnd:a?null:new Date(t.get("eventEnd")),description:t.get("description"),participants:P,address:{url:D.url,lat:D.lat,lng:D.lng,formattedAddress:D.formattedAddress,vicinity:D.vicinity}};try{d.Wo.parse(l);let e=await s(l);(null==e?void 0:e.ok)&&(m.o.success(e.message),S.push("/events"))}catch(e){console.log(e),e instanceof g.z.ZodError?e.errors.forEach(e=>{let t=e.path[0];E(a=>({...a,[t]:{message:e.message,value:!0}}))}):e instanceof Error&&(m.o.error(e.message),console.log(e)),m.o.error("Une erreur est survenue \uD83D\uDE11")}};return(0,l.jsxs)("div",{className:"w-full max-w-[900px] mx-auto",children:[(0,l.jsxs)("header",{className:"relative w-full mb-5",children:[(0,l.jsx)("h1",{className:"text-4xl font-bold",children:"Cr\xe9er un \xe9ventement \uD83D\uDE80"}),(0,l.jsx)("button",{onClick:()=>S.back(),children:(0,l.jsx)(o.In,{type:"goBack",strokeWidth:2,className:"size-10 absolute right-[10px] top-[10px]"})})]}),(0,l.jsxs)("main",{className:"flex flex-col items-center justify-center mb-5 w-full relative rounded-xl border-2 border-light-borderCards bg-light-cards dark:border-dark-borderCards dark:bg-dark-cards",children:[(0,l.jsxs)("form",{className:"flex flex-col w-full gap-5 ",onSubmit:U,children:[(0,l.jsxs)("header",{className:"h-[300px] w-full border-b-2 rounded-tl-lg rounded-tr-lg border-black dark:border-dark-borderCards relative hover:bg-light-grey/10 bg-cover bg-center",style:{backgroundImage:"url(".concat(L,")")},children:[(0,l.jsx)("input",{ref:C,onChange:()=>F(),onKeyDown:e=>{"Enter"===e.key&&e.preventDefault()},type:"file",accept:"image/*",name:"image",required:!0,className:"relative h-full w-full opacity-0 cursor-pointer"}),(0,l.jsx)("span",{className:"absolute left-[50%] top-[50%] translate-x-[-50%] translate-y-[-50%] text-2xl dark:text-light-grey/50 cursor-pointer ".concat(k.image.value?"text-red-500":""),children:k.image.value?k.image.message:"S\xe9lectionner une image"})]}),(0,l.jsxs)("section",{className:"flex w-full gap-5 mt-2 justify-between  flex-wrap px-5",children:[(0,l.jsxs)("fieldset",{className:"flex flex-col sm:w-[50%] ",children:[(0,l.jsxs)("div",{className:"flex w-full gap-2 flex-col",children:[(0,l.jsx)("input",{className:"newEventInput sm:!w-[500px] ",type:"text",name:"title",placeholder:"Titre du \xe9v\xe9nement (max 100 caract\xe8res)",required:!0}),(null===(t=k.title)||void 0===t?void 0:t.value)&&(0,l.jsx)("span",{className:"text-red-500 text-[1.2rem] mx-auto",children:null===(a=k.title)||void 0===a?void 0:a.message}),(0,l.jsxs)("select",{className:"newEventInput",name:"category",children:[(0,l.jsx)("option",{children:"Cat\xe9gorie"}),N.map(e=>(0,l.jsx)("option",{value:e.id,children:e.title},e.id))]}),(null===(r=k.category)||void 0===r?void 0:r.value)&&(0,l.jsx)("span",{className:"text-red-500 text-[1.2rem]",children:null===(x=k.category)||void 0===x?void 0:x.message})]}),(0,l.jsxs)("div",{className:"flex flex-col gap-2 mt-5",children:[(0,l.jsx)("button",{type:"button",className:"primary-btn h-10",onClick:()=>I(!0),children:"Inviter des participants"}),(0,l.jsxs)("label",{htmlFor:"isPublic",className:"text-xl flex gap-2 select-none ml-2",children:[(0,l.jsx)("input",{type:"checkbox",name:"isPublic",id:"isPublic",className:"w-4"}),"\xc9v\xe9nement publique"]})]})]}),(0,l.jsxs)("fieldset",{className:"flex flex-col gap-2",children:[(0,l.jsxs)("label",{htmlFor:"eventStart",className:"text-2xl flex flex-col gap-2",children:["Commence le:",(0,l.jsx)("input",{className:"newEventInput !w-[250px] sm:w-[320px] sm:ml-3",type:"datetime-local",name:"eventStart",placeholder:"Date de d\xe9but"})]}),(null===(p=k.eventStart)||void 0===p?void 0:p.value)&&(0,l.jsx)("span",{className:"text-red-500 text-[1.2rem] mx-auto",children:null===(v=k.eventStart)||void 0===v?void 0:v.message}),(0,l.jsxs)("label",{htmlFor:"eventEnd",className:"text-2xl flex flex-col gap-2",children:["Se termine le:",(0,l.jsx)("input",{className:"newEventInput !w-[250px] sm:w-[320px] sm:ml-3",type:"datetime-local",name:"eventEnd",placeholder:"Date de fin"})]}),(0,l.jsxs)("label",{htmlFor:"endSameDay",className:"text-xl flex gap-2 select-none ml-3",children:[(0,l.jsx)("input",{type:"checkbox",name:"endSameDay",id:"endSameDay",className:"w-4"}),"Se termine la m\xeame journ\xe9e"]}),(null===(f=k.eventEnd)||void 0===f?void 0:f.value)&&(0,l.jsx)("span",{className:"text-red-500 text-[1.2rem]",children:null===(b=k.eventEnd)||void 0===b?void 0:b.message})]})]}),(0,l.jsxs)("section",{className:"flex gap-5 w-full justify-between items-start mt-2 flex-wrap px-5 ",children:[(0,l.jsx)("textarea",{className:"p-4 mt-10 border-2 border-black dark:border-dark-grey/50 rounded-lg dark:bg-transparent dark:placeholder:text-dark-greenLight/50 w-full",rows:10,name:"description",placeholder:"Description du \xe9v\xe9nement (entre 30 et 1000 caract\xe8res \uD83D\uDE09)"}),(null===(h=k.description)||void 0===h?void 0:h.value)&&(0,l.jsx)("span",{className:"text-blue-500 text-[1.2rem] mx-auto",children:null===(j=k.description)||void 0===j?void 0:j.message})]}),(0,l.jsxs)("section",{className:"w-full px-5",children:[(0,l.jsx)("h3",{className:"text-2xl",children:"Ubication :"}),(0,l.jsx)("span",{className:"text-red-500",children:(null===(y=k.address)||void 0===y?void 0:y.message)?null===(w=k.address)||void 0===w?void 0:w.message:""}),(0,l.jsx)("div",{className:"",children:(0,l.jsx)(i.A,{onAddressChange:A})})]}),(0,l.jsx)("div",{className:"w-full p-5",children:(0,l.jsx)("button",{className:"primary-btn w-full",type:"submit",children:"Cr\xe9er l'\xe9v\xe9nement"})})]}),_&&(0,l.jsx)("div",{className:"fixed top-0 left-0 w-full h-full bg-black/80 flex justify-center items-center sm:pt-20",children:(0,l.jsx)(n.A,{users:z,takeUsers:e=>{M(e),I(!1)},closeModal:()=>{M([]),I(!_)}})})]})]})}},2085:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});var l=a(5155),r=a(4788),s=a(2115);function n(e){let{users:t,takeUsers:a,closeModal:n,preSelectedUsers:i}=e,[d,o]=(0,s.useState)(null!=i?i:[]),[c,u]=(0,s.useState)(t),m=e=>{u(t.filter(t=>{var a;return null===(a=t.username)||void 0===a?void 0:a.toLowerCase().includes(e.toLowerCase())}))};(0,s.useEffect)(()=>(document.body.classList.add("no-scroll"),()=>{document.body.classList.remove("no-scroll")}),[]);let g=e=>{o(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])};return(0,l.jsxs)("div",{className:"w-full max-w-[320px] 4xl:max-w-[420px] h-[85vh] max-h-[700px] flex flex-col justify-between gap-2 p-4 rounded-xl border bg-light-cards dark:bg-dark-bg mx-2 mt-2",children:[(0,l.jsxs)("header",{className:"w-full",children:[(0,l.jsx)("p",{className:"text-2xl font-semibold mb-3",children:"Mes contactes"}),(0,l.jsx)("input",{type:"search",onChange:e=>m(e.target.value),placeholder:"Rechercher...",className:"newEventInput !bg-light-grey dark:!bg-transparent"})]}),(0,l.jsxs)("ul",{className:"flex flex-col w-full h-full no-scrollbar overflow-y-scroll inset-shadow-lg border border-light-borderCards dark:border-dark-borderCards rounded-lg p-2 bg-light-ciel dark:bg-dark-bg ",children:[0===c.length&&(0,l.jsx)("p",{className:"text-center opacity-50",children:"Aucun utilisateur trouv\xe9"}),c.map(e=>(0,l.jsxs)("li",{className:"cursor-pointer flex gap-2 bg-light-blue dark:bg-dark-cards items-end my-2 border-2 rounded-lg p-2 ".concat(d.includes(e.id)?"border-light-yellow":"border-inherit"),onClick:()=>g(e.id),children:[(0,l.jsx)("div",{className:"shrink-1",children:(0,l.jsx)(r.UserAvatar,{src:e.image})}),(0,l.jsx)("span",{children:e.username})]},e.id))]}),(0,l.jsxs)("footer",{className:"flex flex-col gap-2 ",children:[(0,l.jsx)("button",{className:"primary-btn w-full",onClick:()=>{a(d)},children:"Confirmer"}),(0,l.jsx)("button",{className:"secondary-btn w-full",onClick:n,children:"Annuler"})]})]})}},6583:(e,t,a)=>{"use strict";a.d(t,{A:()=>i});var l=a(5155),r=a(9047),s=a(2115);let n=["places"],i=e=>{var t;let{onAddressChange:a,existingAddress:i}=e,[d,o]=(0,s.useState)(!1),[c,u]=(0,s.useState)({lat:53.54992,lng:10.00678}),[m,g]=(0,s.useState)(10),x=(0,s.useRef)(null);return(0,s.useEffect)(()=>{i&&(u({lat:i.lat,lng:i.lng}),g(20)),window.google&&delete window.google},[i]),(0,s.useEffect)(()=>{d||o(!0)},[d]),(0,l.jsx)(r.aJ,{googleMapsApiKey:"AIzaSyCiMsDYapFEot5flJzFKDVYYkdRf1ORFfQ",libraries:n,children:d&&(0,l.jsxs)("div",{children:[(0,l.jsx)(r.jT,{onLoad:e=>{x.current=e},onPlaceChanged:()=>{if(x.current){var e;let t=x.current.getPlace();if((null==t?void 0:t.geometry)&&(null===(e=t.geometry)||void 0===e?void 0:e.location)){let e={url:t.url,lat:t.geometry.location.lat(),lng:t.geometry.location.lng(),formattedAddress:t.formatted_address,vicinity:t.vicinity};u({lat:e.lat,lng:e.lng}),g(20),a(e)}}},children:(0,l.jsx)("input",{placeholder:"Chercher un lieu",className:"newEventInput w-full mb-5",defaultValue:null!==(t=null==i?void 0:i.formattedAddress)&&void 0!==t?t:""})}),(0,l.jsx)("div",{className:"rounded-lg border-2 border-black dark:border-dark-grey/50 overflow-hidden h-[500px] w-full",children:(0,l.jsx)(r.u6,{center:c,zoom:m,mapContainerStyle:{width:"100%",height:"100%"},children:(0,l.jsx)(r.pH,{position:c})})})]})})}},1108:(e,t,a)=>{"use strict";a.d(t,{$w:()=>i,Ug:()=>n,Wo:()=>o,jk:()=>s,q8:()=>c,y4:()=>r});var l=a(3415);let r=l.z.object({email:l.z.string().email({message:"Veuillez utiliser une adresse e-mail valide"})}),s=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[#@$!%*?&])[A-Za-z\d#@$!%*?&]{8,30}$/,n="8 caract\xe8res, une majuscule, une minuscule, un chiffre et un caract\xe8re sp\xe9cial, ' \" _ - ne sont pas autoris\xe9s",i=l.z.object({password:l.z.string().min(8,{message:"Le mot de passe doit \xeatre de 8 caract\xe8res minimum"}).max(30,{message:"Le mot de passe doit \xeatre de 30 caract\xe8res maximum"}).regex(s,{message:n})});l.z.object({email:l.z.string().email({message:"Veuillez utiliser une adresse e-mail valide"})});let d=l.z.object({url:l.z.string().url(),lat:l.z.number(),lng:l.z.number(),formattedAddress:l.z.string(),vicinity:l.z.string()}),o=l.z.object({categoryId:l.z.string(),title:l.z.string().max(100,{message:"Le titre doit \xeatre de 100 caract\xe8res maximum"}),description:l.z.string().min(30,{message:"Il faut un peu de l'inspiration pour cette description!"}).max(1e3,{message:"La description doit \xeatre de 1000 caract\xe8res maximum"}),eventStart:l.z.date().refine(e=>{let t=new Date;return!isNaN(e.getTime())&&e>=t},{message:"La date doit \xeatre valide et ne peut pas \xeatre dans le pass\xe9"}),eventEnd:l.z.date().nullable().refine(e=>{if(!e)return!0;let t=new Date;return!isNaN(e.getTime())&&e>=t},{message:"La date doit \xeatre valide et ne peut pas \xeatre dans le pass\xe9"}),isPublic:l.z.boolean(),participants:l.z.array(l.z.string()),address:d,image:l.z.instanceof(File)});l.z.string().regex(new RegExp("^(".concat("sport|education|language|city tours|air libre|autres",")$")),{message:"Titre invalide"});let c=l.z.object({username:l.z.string().max(30,"Le nom d'utilisateur doit comporter 30 caract\xe8res ou moins").optional(),image:l.z.union([l.z.instanceof(File).refine(e=>e.size<=2097152,{message:"La taille de l'image doit \xeatre de 2 Mo ou moins"}),l.z.null(),l.z.undefined()]).optional(),description:l.z.string().max(1e3,"La description doit comporter 1000 caract\xe8res ou moins").optional(),oldImage:l.z.string().optional()}),u=l.z.object({id:l.z.string(),email:l.z.string().email().nullable(),username:l.z.string().nullable(),image:l.z.string().nullable(),description:l.z.string().nullable(),_count:l.z.object({Ratings:l.z.number(),EventsCreated:l.z.number()})});l.z.array(u)},5353:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"useMergedRef",{enumerable:!0,get:function(){return r}});let l=a(2115);function r(e,t){let a=(0,l.useRef)(()=>{}),r=(0,l.useRef)(()=>{});return(0,l.useMemo)(()=>e&&t?l=>{null===l?(a.current(),r.current()):(a.current=s(e,l),r.current=s(t,l))}:e||t,[e,t])}function s(e,t){if("function"!=typeof e)return e.current=t,()=>{e.current=null};{let a=e(t);return"function"==typeof a?a:()=>e(null)}}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},4788:(e,t,a)=>{"use strict";a.r(t),a.d(t,{UserAvatar:()=>s});var l=a(5155),r=a(5565);let s=e=>{let{className:t,src:a,onClick:s}=e,n=a&&a.trim()?a:"/images/DefaultUserAvatar1.png";return(0,l.jsx)("div",{className:"".concat(t||"size-12"," ").concat(s?"cursor-pointer":""," relative overflow-hidden rounded-full"),onClick:s,"aria-label":"User avatar",children:(0,l.jsx)(r.default,{width:350,height:350,src:n,className:"rounded-full border border-card object-cover overflow-hidden",alt:"user avatar"})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[7261,6084,815,5565,814,3240,8441,1517,7358],()=>t(933)),_N_E=e.O()}]);
//# sourceMappingURL=page-add8ebd59750d04d.js.map