(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6636],{4588:(e,r,t)=>{Promise.resolve().then(t.bind(t,4580)),Promise.resolve().then(t.bind(t,6903)),Promise.resolve().then(t.bind(t,171)),Promise.resolve().then(t.bind(t,371)),Promise.resolve().then(t.bind(t,3976)),Promise.resolve().then(t.bind(t,3126)),Promise.resolve().then(t.bind(t,4788))},2085:(e,r,t)=>{"use strict";t.d(r,{A:()=>n});var l=t(5155),a=t(4788),s=t(2115);function n(e){let{users:r,takeUsers:t,closeModal:n,preSelectedUsers:c}=e,[i,o]=(0,s.useState)(null!=c?c:[]),[d,u]=(0,s.useState)(r),h=e=>{u(r.filter(r=>{var t;return null===(t=r.username)||void 0===t?void 0:t.toLowerCase().includes(e.toLowerCase())}))};(0,s.useEffect)(()=>(document.body.classList.add("no-scroll"),()=>{document.body.classList.remove("no-scroll")}),[]);let x=e=>{o(r=>r.includes(e)?r.filter(r=>r!==e):[...r,e])};return(0,l.jsxs)("div",{className:"w-full max-w-[320px] 4xl:max-w-[420px] h-[85vh] max-h-[700px] flex flex-col justify-between gap-2 p-4 rounded-xl border bg-light-cards dark:bg-dark-bg mx-2 mt-2",children:[(0,l.jsxs)("header",{className:"w-full",children:[(0,l.jsx)("p",{className:"text-2xl font-semibold mb-3",children:"Mes contactes"}),(0,l.jsx)("input",{type:"search",onChange:e=>h(e.target.value),placeholder:"Rechercher...",className:"newEventInput !bg-light-grey dark:!bg-transparent"})]}),(0,l.jsxs)("ul",{className:"flex flex-col w-full h-full no-scrollbar overflow-y-scroll inset-shadow-lg border border-light-borderCards dark:border-dark-borderCards rounded-lg p-2 bg-light-ciel dark:bg-dark-bg ",children:[0===d.length&&(0,l.jsx)("p",{className:"text-center opacity-50",children:"Aucun utilisateur trouv\xe9"}),d.map(e=>(0,l.jsxs)("li",{className:"cursor-pointer flex gap-2 bg-light-blue dark:bg-dark-cards items-end my-2 border-2 rounded-lg p-2 ".concat(i.includes(e.id)?"border-light-yellow":"border-inherit"),onClick:()=>x(e.id),children:[(0,l.jsx)("div",{className:"shrink-1",children:(0,l.jsx)(a.UserAvatar,{src:e.image})}),(0,l.jsx)("span",{children:e.username})]},e.id))]}),(0,l.jsxs)("footer",{className:"flex flex-col gap-2 ",children:[(0,l.jsx)("button",{className:"primary-btn w-full",onClick:()=>{t(i)},children:"Confirmer"}),(0,l.jsx)("button",{className:"secondary-btn w-full",onClick:n,children:"Annuler"})]})]})}},3976:(e,r,t)=>{"use strict";t.d(r,{default:()=>c});var l=t(5155),a=t(7490),s=t(6046),n=t(2115);function c(e){let{title:r}=e,t="",[c,i]=(0,n.useState)(!1),o=(0,s.useRouter)(),d=(0,s.useSearchParams)(),[u,h]=(0,n.useState)(d.get("search")||""),x=(0,n.useCallback)(e=>{let r=new URLSearchParams(d.toString());e?r.set("search",e):r.delete("search"),o.push("?".concat(r.toString()))},[d,o]);switch((0,n.useEffect)(()=>{let e=setTimeout(()=>{x(u)},500);return()=>clearTimeout(e)},[u,x]),r){case"users":t="Un nom ? Une ville ?";break;case"events":t="mot cl\xe9, lieu, date ?";break;case"messages":t="Un conversation ? Un sujet ?";break;case"all":t="Un mot cl\xe9, un contact, une t\xe2che ?";break;default:t="Un mot cl\xe9 ?"}return(0,l.jsxs)("div",{className:"relative flex w-full max-w-[500px] overflow-visible",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 w-full",children:[(0,l.jsx)("input",{type:"search",value:u,onChange:e=>{h(e.target.value)},placeholder:t,className:"w-full h-10 p-5 text-xl placeholder:select-none dark:placeholder:text-dark-greenLight/50 border-2 border-dark-bg dark:bg-dark-bg dark:border-light-grey rounded-lg"}),(0,l.jsx)(a.In,{onClick:()=>i(!c),type:"search",width:40})]}),c&&(0,l.jsxs)("div",{className:"absolute select-none z-50 top-12 right-0 w-full dark:bg-dark-bg bg-light-blue border border-light-grey rounded-lg shadow-lg p-4",children:[(0,l.jsx)("h3",{className:"text-lg font-bold mb-4 text-light-grey",children:"Filtrer et Trier"}),(0,l.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"sort",className:"block text-sm text-light-grey mb-2",children:"Trier par"}),(0,l.jsxs)("select",{id:"sort",className:"newEventInput",children:[(0,l.jsx)("option",{value:"date",children:"Plus r\xe9cent"}),(0,l.jsx)("option",{value:"popularit\xe9",children:"Plus populaire"}),(0,l.jsx)("option",{value:"proximit\xe9",children:"Plus ancien"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"category",className:"text-sm text-light-grey mb-2 sm:hidden",children:"Cat\xe9gorie"}),(0,l.jsxs)("select",{id:"category",className:"newEventInput sm:hidden",children:[(0,l.jsx)("option",{value:"toutes",children:"Toutes les cat\xe9gories"}),(0,l.jsx)("option",{value:"culture",children:"Culture"}),(0,l.jsx)("option",{value:"sport",children:"Sport"}),(0,l.jsx)("option",{value:"\xe9ducation",children:"\xc9ducation"})]})]}),(0,l.jsx)("button",{onClick:()=>i(!1),className:"w-full p-2 bg-light-yellow text-dark-bg font-bold rounded-lg hover:bg-light-yellow/80",children:"Appliquer"})]})]})]})}},4580:(e,r,t)=>{"use strict";t.d(r,{default:()=>v});var l=t(5155),a=t(5828);let s=(0,a.createServerReference)("7f86c437f75ffeab4332bd128663d1faa33add1145",a.callServer,void 0,a.findSourceMapURL,"sendInvitationToEvent");var n=t(2085),c=t(7490),i=t(3126),o=t(2115),d=t(814);function u(e){let{children:r,color:t="primary",size:a="medium",outline:s=!1,rounded:n="pill",className:c="",onClick:i}=e,o={primary:{bg:"bg-light-ciel dark:bg-dark-greenLight/70",text:"text-black dark:text-white",ring:"ring-2 ring-light-ciel dark:ring-dark-greenLight"},secondary:{bg:"bg-purple-100 dark:bg-purple-900/70",text:"text-purple-800 dark:text-purple-100",ring:"ring-2 ring-purple-500"},success:{bg:"bg-green-100 dark:bg-green-900/70",text:"text-green-800 dark:text-green-100",ring:"ring-2 ring-green-500"},warning:{bg:"bg-yellow-100 dark:bg-yellow-900/70",text:"text-yellow-800 dark:text-yellow-100",ring:"ring-2 ring-yellow-500"},error:{bg:"bg-red-100 dark:bg-red-900/70",text:"text-red-800 dark:text-red-100",ring:"ring-2 ring-red-500"},info:{bg:"bg-blue-100 dark:bg-blue-900/70",text:"text-blue-800 dark:text-blue-100",ring:"ring-2 ring-blue-500"}},d=s?"bg-transparent ".concat(o[t].text," ").concat(o[t].ring):"".concat(o[t].bg," ").concat(o[t].text);return(0,l.jsx)("div",{onClick:i,className:"inline-flex items-center font-[500] transition-all cursor-pointer ".concat({small:"px-2 py-0.5 text-xs",medium:"px-3 py-1 text-sm",large:"px-4 py-1.5 text-base"}[a]," ").concat({pill:"rounded-full",circle:"rounded-lg"}[n]," ").concat(d," ").concat(c),children:r})}var h=t(2432),x=t(171);let g=(0,a.createServerReference)("7fd919d4267e3516d1ebfb2bae9c83eac9c99aecc3",a.callServer,void 0,a.findSourceMapURL,"deleteEvent");var p=t(7650);function f(e){let{text:r,loadingText:t,className:a}=e,{pending:s}=(0,p.useFormStatus)();return(0,l.jsx)("button",{type:"submit",className:"primary-btn ".concat(a),children:s?t:r})}var m=t(6046);function b(e){let{eventId:r,toggleModal:t}=e,a=async e=>{e.preventDefault();try{await g({eventId:r}),d.o.success("\xc9v\xe9nement supprim\xe9 avec succ\xe8s")}catch(e){console.error(e)}(0,m.redirect)("/profile")};return(0,l.jsx)("div",{className:"absolute top-0 left-0 w-full h-full rounded-lg bg-black/90 flex items-center justify-center",children:(0,l.jsxs)("div",{className:"flex flex-col gap-2 w-full text-center",children:[(0,l.jsx)("h1",{className:"font-bold text-2xl",children:"\xcates-vous s\xfbr de vouloir supprimer cet \xe9v\xe9nement ?"}),(0,l.jsx)("p",{className:"text-center text-lg font-extralight",children:"Cette action est irr\xe9versible."}),(0,l.jsxs)("form",{onSubmit:e=>a(e),className:"flex flex-wrap w-full justify-center gap-2",children:[(0,l.jsx)(f,{text:"Supprimer",loadingText:"Suppression...",className:"secondary-btn"}),(0,l.jsx)("button",{onClick:t,className:"primary-btn",children:"Non, annuler"})]})]})})}function v(e){var r,t;let{event:a,contacts:g}=e,[p,f]=(0,o.useState)(!1),[m,v]=(0,o.useState)(!1),[k,j]=(0,o.useState)(!1),y=function(e){let r=new Date;return Math.round((e.getTime()-r.getTime())/864e5)}(a.eventStart),w=null===(r=a.tasks)||void 0===r?void 0:r.filter(e=>!e.completed),N=()=>{v(!m)},S=()=>{j(!k)},C=async e=>{let r=await s({eventId:a.id,participantsIds:e});(null==r?void 0:r.ok)?d.o.success(r.message):d.o.error(r.message),S()};return(0,l.jsxs)("div",{className:"relative flex flex-col gap-2 justify-between w-full h-fit p-5 border border-dark-bg dark:border-light-grey rounded-lg bg-card",children:[(0,l.jsxs)("div",{className:"font-extralight text-lg flex flex-wrap items-center gap-5 select-none",children:[(0,l.jsx)("h1",{className:"font-bold text-2xl",children:a.title}),y>0?(0,l.jsx)(u,{color:"warning",onClick:()=>f(!p),children:(0,l.jsxs)("p",{children:[y," jours restants"]})}):(0,l.jsx)(u,{color:"info",onClick:()=>f(!p),children:(0,l.jsxs)("p",{children:["Passé il fait ",y," ",y>1?"jours":"jour"]})}),a.participants&&(0,l.jsxs)(u,{onClick:()=>f(!p),color:"success",children:[a.participants.length," ",a.participants.length>1?"participants":"participant"]}),(0,l.jsx)(u,{onClick:()=>f(!p),color:"error",children:(0,l.jsxs)("p",{children:[(null==w?void 0:w.length)||0," t\xe2ches \xe0 accomplir"]})}),(0,l.jsx)("div",{className:"absolute right-5 top-7",children:p?(0,l.jsx)(c.In,{type:"minus",strokeWidth:3,onClick:()=>f(!1)}):(0,l.jsx)(c.In,{type:"plus",strokeWidth:3,onClick:()=>f(!0)})})]}),(0,l.jsxs)("div",{className:"overflow-hidden transition-all duration-500 ease-in-out ".concat(p?"max-h-[500px] opacity-100":"max-h-0 opacity-0"),children:[(0,l.jsxs)("div",{className:"flex flex-wrap gap-2 mt-2 mb-5",children:[(0,l.jsx)(i.Link,{href:"/events/edit/".concat(a.id),className:"primary-btn",children:"\xc9diter"}),(0,l.jsx)("button",{className:"primary-btn",onClick:()=>j(!0),children:"G\xe9rer les participants"}),(0,l.jsx)("button",{className:"secondary-btn",onClick:N,children:"Supprimer"})]}),(0,l.jsx)("div",{className:"flex justify-start items-center mb-10",children:(0,l.jsx)(h.default,{event:a})}),(0,l.jsx)(x.default,{tasks:a.tasks||[],eventId:a.id})]}),m&&(0,l.jsx)(b,{eventId:a.id,toggleModal:N}),k&&(0,l.jsx)("div",{className:"fixed z-[100] top-0 left-0 w-full h-full bg-black/80 flex justify-center items-center sm:pt-20",children:(0,l.jsx)(n.A,{users:g,takeUsers:C,closeModal:S,preSelectedUsers:null===(t=a.participants)||void 0===t?void 0:t.map(e=>e.userId)})})]})}},6903:(e,r,t)=>{"use strict";t.d(r,{default:()=>n});var l=t(5155),a=t(5828);let s=(0,a.createServerReference)("0020711e683fce2295dcae5b03dba6b4bb1f7f7653",a.callServer,void 0,a.findSourceMapURL,"handleSignOut");t(2115);let n=()=>(0,l.jsx)("button",{className:"secondary-btn",onClick:()=>s(),children:"D\xe9connexion"})},171:(e,r,t)=>{"use strict";t.d(r,{default:()=>h});var l=t(5155),a=t(5828);let s=(0,a.createServerReference)("7f18c30c8768a9e22fdb2c3dd272f2ab4d6f47def8",a.callServer,void 0,a.findSourceMapURL,"createTask"),n=(0,a.createServerReference)("7f79946f45de2eea1739a88c4620698c367ede93b0",a.callServer,void 0,a.findSourceMapURL,"deleteUserTask"),c=(0,a.createServerReference)("7fb44f0178c4951b568ad269ec66e74635f4a91807",a.callServer,void 0,a.findSourceMapURL,"updateTask");var i=t(7490),o=t(2906),d=t(901),u=t(2115);function h(e){let{tasks:r,eventId:t}=e,[a,h]=(0,u.useState)(r),[x,g]=(0,u.useState)(null),[p,f]=(0,u.useState)(""),m=(0,u.useRef)(null),b=(0,u.useRef)(null),v=(0,u.useRef)([]);(0,u.useEffect)(()=>{a.forEach((e,r)=>{let t=v.current[r];t&&(t.style.height="10px",t.style.height="".concat(t.scrollHeight+1,"px"))}),b.current&&(b.current.style.height="10px",b.current.style.height="".concat(b.current.scrollHeight+1,"px"))},[a]),(0,u.useEffect)(()=>{let e=()=>{x&&j()};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}},[x,p]);let k=async e=>{if(!e)return;let r=await n(e);(null==r?void 0:r.ok)&&h(a.filter(r=>r.id!==e))},j=async()=>{if(!x)return;if(0===p.length){await k(x.id);return}let e={...x,content:p.trim()};try{(await c(e)).ok&&h(a.map(r=>r.id===e.id?e:r))}catch(e){console.error(e)}},y=async(e,r)=>{if(!r||!r.content)return;let t={...r,completed:e.target.checked};try{await c(t),h(a.map(e=>e.id===t.id?t:e))}catch(e){console.error(e)}},w=async e=>{e.preventDefault();let r=new FormData(e.currentTarget).get("content");if(0===r.length)return;let l=a.map((e,r)=>(e.order=r+1,e)),n=await s({content:r,completed:!1,eventId:t||null});(null==n?void 0:n.ok)&&(h([n.newTask,...l]),e.target.reset(),b.current&&(b.current.style.width="100%"))},N=(e,r)=>{if("number"==typeof r){let t=[...a];t[r]={...t[r],content:e.target.value},h(t);let l=v.current[r];l&&(l.style.height="10px",l.style.height="".concat(l.scrollHeight+1,"px"))}else b.current&&(b.current.style.height="10px",b.current.style.height="".concat(b.current.scrollHeight+1,"px"));f(e.target.value)},S=e=>{if("Enter"===e.key){e.preventDefault();let r=e.currentTarget.closest("form");r&&r.requestSubmit()}},C=async()=>{try{for(let e of a)await c(e)}catch(e){console.error("Error al actualizar el orden de las tareas",e)}},L=async e=>{h(e.map((e,r)=>({...e,order:r+1})))};return(0,l.jsxs)("div",{className:"w-full flex flex-col items-center flex-wrap sm:!items-start",children:[(0,l.jsx)("form",{onSubmit:e=>w(e),className:"flex items-end gap-5 mb-2 w-full",children:(0,l.jsxs)("div",{className:"flex w-full gap-5",children:[(0,l.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,l.jsx)(i.In,{className:"hover:text-red-600 dark:hover:text-dark-greenLight hover:scale-110",type:"menu",width:35}),(0,l.jsx)("button",{"aria-label":"Ajouter une t\xe2che",children:(0,l.jsx)(i.In,{type:"add",className:"hover:text-red-600 dark:hover:text-dark-greenLight hover:scale-110",width:35})})]}),(0,l.jsx)("textarea",{ref:b,name:"content",placeholder:"Nouvelle t\xe2che",autoComplete:"off",className:"resize-none no-scrollbar w-[90%] bg-transparent ml-2 border-b focus:outline-none border-dark-bg dark:border-light-grey placeholder:text-black/50 placeholder:dark:text-dark-greenLight/50",onChange:e=>N(e),onKeyDown:e=>S(e)})]})}),(0,l.jsx)("form",{ref:m,className:"w-full select-none",children:(0,l.jsx)(o.x,{axis:"y",values:a,onReorder:L,children:null==a?void 0:a.map((e,r)=>(0,l.jsxs)(d.N,{value:e,onDragEnd:C,className:"flex gap-2 items-center mt-1",children:[(0,l.jsx)(i.In,{onClick:()=>k(e.id),type:"delete",className:"hover:text-red-600 dark:hover:text-dark-greenLight hover:scale-110"}),(0,l.jsx)(i.In,{type:"draggable",className:"!cursor-grab"}),(0,l.jsx)("input",{"aria-label":"task-checkbox",autoComplete:"off",className:"peer",type:"checkbox",defaultChecked:!!e.completed,onChange:r=>y(r,e)}),(0,l.jsx)("textarea",{rows:1,ref:e=>{e&&(v.current[r]=e)},className:"no-scrollbar resize-none w-full h-10px bg-transparent ml-2 my-1 border-b border-dark-bg dark:border-light-grey/50 focus:outline-none peer-checked:line-through decoration-2 decoration-light-red placeholder:text-light-blue placeholder:dark:text-dark-greenLight/50",onFocus:r=>{g(e),f(r.target.value)},onChange:e=>N(e,r),onBlur:j,onKeyDown:e=>S(e),defaultValue:e.content,placeholder:"..."})]},e.id))})})]})}}},e=>{var r=r=>e(e.s=r);e.O(0,[7261,8173,815,5565,814,8824,6968,4479,8441,1517,7358],()=>r(4588)),_N_E=e.O()}]);
//# sourceMappingURL=page-343f7daec6130a50.js.map